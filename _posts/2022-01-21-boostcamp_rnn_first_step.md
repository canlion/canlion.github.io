---
title: "AI Math 10 - RNN 첫걸음"
excerpt: "시퀀스 데이터의 개념과 특징, RNN, BPTT, 기울기 소실"

categories:
  - boostcamp
tags:
  - [boostcamp]

toc: true
toc_sticky: true

date: 2022-01-21 13:38
last_modified_at: 2021-01-21 13:38
---
# RNN

시계열/시퀀스 데이터에 적용하는 네트워크. 데이터 샘플이 독립적이지 않은 경우가 많다.

## 시퀀스 데이터
소리, 문자열, 주가 등 순차적으로 나열된 데이터. (시간 순서에 따라 나열된 데이터: 시계열 데이터). 앞의 데이터가 뒤의 데이터에 영향을 미칠 수 있다. 그러므로 순서가 매우 중요하다.

시퀀스 데이터는 독립동등분포(i.i.d.) 가정을 잘 위배하므로 순서를 바꾸거나 과거 정보의 손실이 있다면 데이터의 확률분포가 변화함. - 손상된 과거의 정보로 미래를 예측하려는 것이므로 원하는 결과를 얻기 힘들다.

### 조건부 확률의 이용
이전 시퀀스의 정보를 통해 앞으로 발생할 데이터의 확률분포를 다룬다.

$$\begin{matrix}
P(X_1,...,X_t) & = & P(X_t\vert X_1,...,X_{t-1})P(X_1,...,X_{t-1}) \\
& = & \prod^t_{s=1}P(X_s\vert X_{s-1},...,X_1)
\end{matrix}$$

$$X_t \sim P(X_t\vert X_{t-1},...,X_1)$$

그렇다고 **항상** 과거의 모든 정보가 필요하지는 않다. (ex - 주가 예측에 수십년전의 주가 정보까지 사용하지는 않는다.)

### 가변적인 데이터를 다룰 수 있는 방법이 필요
조건부에 들어가는 데이터 길이가 가변적

$$X_t \sim P(X_t\vert X_{t-1},...,X_1)$$
$$X_{t+1} \sim P(X_{t+1}\vert X_t,X_{t-1},...,X_1)$$

1. 고정된 길이의 정보만 다루자 - 고정된 길이 $\tau$만큼의 데이터만 이용하자.
    * AR($\tau$) - Autoregressive Model
2. 직전 정보를 제외한 과거의 정보를 하나의 변수로 인코딩해 이용하자.
    * 잠재 AR 모델 - 이전 정보를 제외한 나머지 정보들을 잠재변수 $H_t$로 인코딩하여 활용
    * $X_t \sim P(X_t\vert X_{t-1},...,X_1) \rightarrow X_t \sim P(X_t\vert X_{t-1}, H_t)$ <br>
      $X_{t+1} \sim P(X_{t+1}\vert X_{t},...,X_1) \rightarrow X_{t+1} \sim P(X_{t+1}\vert X_{t}, H_{t+1})$ 