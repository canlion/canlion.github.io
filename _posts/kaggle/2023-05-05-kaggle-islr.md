---
title: "DL/동작인식/🥈] Google - Isolated Sign Language Recognition"
excerpt: "키 포인트 시퀀스 동작 분류"

categories:
  - kaggle
tags:
  - []

toc: true
toc_sticky: true

date: 2023-05-05T13:50:00+09:00
last_modified_at: 2023-05-05T13:50:00+09:00
---

## 문제
* American Sign Language (ASL) 분류 문제
  * **청각 장애를 가진 아이들이 수화를 즐겁게 배울 수 있는 게임**을 만들기 위해 ASL 분류 엔진이 필요

## 문제 조건
* 입력: mediapipe holistic 엔진으로 제작된 키 포인트 시퀀스 - 543개 키 포인트, 임의의 수의 프레임 시퀀스 
* 출력: 250개 카테고리 분류
* 조건:
  * TFLite 모델 제출
    * 40MB 이하
    * 40000개의 테스트 샘플 / 샘플당 평균 0.1초 이하의 latency

## 내 풀이

* 트랜스포머를 기본 모델로 선택
  * 데이터가 많지는 않다고 생각 - 임베딩 네트워크를 크게 만드는 방향으로 진행
  * 전체 키포인트 중 얼굴 mesh 대부분을 제외함 / 손, 눈, 코, 입, 귀, 어깨, 팔꿈치 키 포인트 이용 
    * ![parts](/images/kaggle/islr/parts.png)

### 데이터
  * 9만여개의 샘플
  * 250개 카테고리 - 카테고리별로 약 300여개의 샘플이 균형있게 분포
  * 10여명의 사람들이 반복해서 비디오 생성
  * 샘플마다 2 ~ 550 프레임

### 전처리

z 좌표는 제거 - xy만을 이용하는 것이 더 쉽게 학습

1. nan 값을 제외하고 프레임 단위로 정규화 후 왼손, 오른손, 나머지 파트 키 포인트 추출
  * 프레임 단위로 각 부분의 위치 관계를 활용
  * 얼굴 mesh도 포함하여 정규화 - 얼굴 mesh의 수가 압도적으로 많아 중심점 역할을 기대
2. 왼손, 오른손 키 포인트 추출 후 각각 정규화
  * 각 프레임 단위로 손의 동작을 활용
  * 오른손은 수평 반전하여 정규화 - 왼손과 같은 네트워크를 사용하므로 각 키 포인트의 위치관계의 분산을 줄이기위해
3. **1** 과는 다르게 프레임 상관 없이 샘플 단위로 정규화 후 모든 파트 키 포인트 추출
  * "키 포인트의 이동"을 feature로 이용
  * [DD-Net](https://arxiv.org/pdf/1907.09658v8.pdf) 

* augmentation
  * 수평 반전: 이미지, bbox 반전과는 다르게 대칭되는 키포인트들과 위치 교환 필요
  * 노이즈 추가: 키 포인트 좌표에 노이즈 추가
  * xy shift, rotation, shear
  * 프레임 샘플링: 80 % ~ 100 % 샘플링, 샘플마다의 동작 속도에 대한 robustness 추구
  * 비디오 앞뒤로 무작위 샘플의 프레임을 붙임: 동작 전후의 무의미한 움직임에 대해 robustness 추구

### 네트워크

* 표준적인 포지셔널 인코딩 사용 (sin, cos) - max length: 256
* 작은 임베딩 네트워크 다수 사용
  1. 위치 관게 네트워크 - 전처리 **1** 입력
  2. 손 동작 네트워크 - 전처리 **2** 입력
  3. 모션 네트워크 - 전처리 **3** 입력
     * (t+1) 프레임에서 t 프레임을 빼서 좌표 변화를 계산하여 네트워크에 입력
  4. convoltuion
     * (batch, frame, num_kpt, 2) 데이터를 transpose, (batch, num_kpt, frame, 2)로 변환
     * conv2D를 활용해 임의의 frmae 수에도 무관하게 feature 계산
* 임베딩들을 모두 concat 후 트랜스포머에 입력
* stochastic depth

## 성적
* 🥈 27 / 1165

## 후기
* 쥬피터 노트북 활용시에 실험 관리를 어떻게 해야할까?
* 너무 임베딩 네트워크 구조로만 어떻게 해보려다가 금방 한계를 만남
  * 작은 모델로 실험해보고 모델을 키워 제출했으나 성능 향상이 미비했음
* EDA 열심히 하자