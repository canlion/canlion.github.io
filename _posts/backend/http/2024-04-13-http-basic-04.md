---
title: "HTTP 웹 기본 지식 정리 - http 메서드"
excerpt: ""

categories:
  - http
tags:
  - [http]

# author_profile: true
# sidebar:
#   nav: "sidebar_category"

toc: true
toc_sticky: true

date: 2024-04-13
last_modified_at: 2024-04-13
---

인프런 / 모든 개발자를 위한 HTTP 웹 기본 지식: [link](https://www.inflearn.com/course/http-%EC%9B%B9-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC)

---

# HTTP 메서드

클라이언트가 서버에 바라는 액션, 처리해주길 바라는 액션.

회원을 관리하는 어플리케이션을 만든다면 "회원"이라는 리소스를 중심으로 API의 URI를 설계한다.
URI는 리소스를 식별하는 용도이므로 액션, 행위가 보이지 않도록 설계한다.
즉, 가능한한 URI에는 "회원"만 나타나고 조회, 생성, 삭제, 수정 등의 행위는 표현되지 않도록 하는 것이 권장된다.
예를 들어 특정 회원 번호를 가진 회원의 정보를 조회한다면 `/members/{id}` 형식으로 URI를 설정할 수 있다.
그렇지만 삭제, 수정 등의 행위를 표현하려면 URI에 행위가 나타날 수 밖에 없다.

이때 사용되는 것이 HTTP 메서드다.
요청 메세지에 HTTP 메서드를 담아 서버에 어떤 처리를 해달라고 요청하는 방식을 이용하자.

**예시** - URI에 "회원"만 표현된다.
* /members/{id} + **GET** 메서드: 회원 번호가 {id}인 회원의 정보 조회 
* /members + 회원 정보 + **POST** 메서드: 회원을 새로 등록
* /members/{id} + 회원 정보 + **PUT** 메서드: 회원 번호가 {id}인 회원 정보를 새 정보로 덮어 씌우기 (회원이 없다면 생성)
* /members/{id} + **DELETE** 메서드: 회원 번호가 {id}인 회원을 삭제
* /members/{id} + 회원 정보 + **PATCH** 메서드: 회원 번호가 {id}인 회원의 정보 변경


## 종류
### GET

```
GET /search?q=http&sourceid=chrome&ie=UTF-8 HTTP/1.1
Host: www.google.com

```

* 리소스 조회에 사용 (ex - 구글에 "http" 검색 결과를 요청)
* 쿼리 파라미터를 사용해 서버에 데이터 전달
  * 예시: `?q=http&sourceid=chrome&ie=UTF-8`
    * q: http / sourceid: chrome / ie: UTF-8
  * 메세지 바디는 사용할 수는 있지만 인터넷의 모든 노드가 지원하지는 않으니 바디를 담지 않는 것이 권장된다.
* 요청이 성공적으로 수행되면 응답 메세지에는 요청한 리소스가 담겨온다.

### POST

```
POST /members HTTP/1.1
...
Content-Type: application/json

{
  "name": "kim",
  "age": 65
}
```

* 메세지 바디에 담은 데이터를 처리해달라고 서버에 요청
  * 어떻게 처리할지는 서버에 구현되어있다.
* 보통 새로운 리소스를 생성하는 경우에 사용된다.
  * 요청이 성공적으로 수행되면 새로 생성된 리소스와 그 경로가 응답에 담겨온다. 
* ex) 신규 회원 가입 처리
  * 이름이 "kim"인 회원 추가(회원번호 32번 부여)
  * 보통 응답 메세지 헤더에는 신규 리소스의 경로 `Location: /members/32`, 메세지 바디에는 신규 리소스 `{"name": "kim"}`이 담겨온다.

#### POST는 여러 용도로 사용된다.

* 신규 리소스 등록
  * 서버에 존재하지 않는 새로운 리소스 생성
  * ex - 신규 회원 가입, 게시판 글 작성, ...
* 요청 데이터 처리
  * 단순히 새로운 리소스의 생성을 넘어 데이터에 대한 프로세스를 처리해야하는 경우
  * 처리 결과로 반드시 새로운 리소스가 생성될 필요는 없음.
  * ex - /members/{id}/delete-all: 어떤 회원의 모든 게시글을 제거하는 기능. (모든 글 제거라는 기능 수행, 리소스 생성 없음)
    * 컨트롤 URI: 행위가 담긴 URI, 리소스만을 표현하는 방식으로 URI 설계가 불가능한 경우 활용
* 다른 메서드로 처리하기 애매한 경우
  * 리소스를 조회하고 싶은데 쿼리파라미터만으로는 부족해 요청 메시지에 메세지 바디로 데이터를 넘겨야하는 경우 GET 메서드를 사용하는 것은 권장되지 않음. 이런 경우 POST 활용.
    * POST가 모든 역할을 대신할 수는 있으나 메서드별로 특화된 기능들이 있음. (ex - GET 메서드 요청이 오면 서버는 자동으로 리소스 캐싱 수행)


### PUT

```
PUT /members/32 HTTP/1.1
...
Content-Type: application/json

{
  "name": "ho",
  "age": 85
}
```

* 리소스 덮어씌우기
  * 리소스가 없다면 생성, 있다면 교체
  * **부분 수정 용도가 아니다! 리소스를 완전히 덮어씌우므로 전달하는 데이터에 리소스의 구성 정보가 모두 포함되어야한다.**
    * 기존 리소스 `{"name": "ho", "age": 65}`에서 나이만 수정한다고 `{"age": 85}`만 보내면 `{"age": 85}`가 기존 리소스를 대체한다. 
* **클라이언트가 특정 리소스를 식별한다 = 리소스의 URI를 지정한다.**
  * POST는 `/members`에 회원 생성을 요청할 뿐이지만 PUT은 `/members/32`로 회원번호 32인 회원을 명시적으로 지정하여 요청한다.
    * 일반적으로 POST는 전달하는 데이터를 처리해달라는 요청이고 PUT은 특정 리소스를 어떻게 해달라는 요청.
* 응답에 리소스 경로와 리소스가 담겨온다.

### PATCH

```
PATCH /members/32 HTTP/1.1
...
Content-Type: application/json

{
  "age": 32
}
```

* 리소스 부분 변경. PUT처럼 특정 리소스를 식별한다.
  * 위 메세지 예시는 리소스의 나이만 32세로 변경한다.
* 지원하지 않는 서버가 있을 수 있다. POST를 쓰자.

### DELETE

```
DELETE /members/32 HTTP/1.1
...

```

* 특정 리소스 제거 요청

## 메서드 속성

![http method 속성](/images/backend/http/http-basic-04/http-method-table-from-wiki.jpg){:.align-center}
출처: [wiki-HTTP](https://ko.wikipedia.org/wiki/HTTP)
{:.text-center}

* 안전(Safe Methods)
  * 리소스를 변경하지 않는 메서드 - GET
* 멱등(Idempotent Methods)
  * 동일한 요청(요청 메세지가 동일)이라면 몇 번을 반복해도 결과가 동일한 메서드 - GET, PUT, DELETE
    * ex) "곱하기 1"은 멱등. 몇 번을 곱해도 결과가 같다. "곱하기 0.5"는 멱등이 아니다. 곱할때마다 값이 절반이 된다.
    * PUT: 리소스를 생성하거나 대체. 기존 리소스가 존재해도, 없어서 새로 생성했어도 같은 데이터로 덮어씌워 결과가 같다.
    * DELETE: 여러번 삭제 요청을 해도 "리소스가 삭제된 상태"는 유지된다.
  * 멱등인 메서드는 서버에서 응답이 없는 경우에 안심하고 다시 요청을 보내도 된다.
    * 서버에서 요청이 정상처리 되었는데 응답 메세지가 전송 중에 소실된건지, 요청 자체가 서버에 도달하지 못했는지, ... 고민하지 않아도 된다. 
  * **POST는 멱등이 아닐 수 있다.** 예를 들어 신규 회원 가입 로직에 회원의 중복 가입을 제한하지 않는다면 동일한 정보로 회원 번호만 다르게하여 중복 가입된다.
* 캐시가능(Cacheable Methods)
  * 캐시: 이전에 보냈던 요청과 현재 보낼 요청이 동일한 경우 이전 요청의 응답을 재활용한다. (큰 이미지를 요청하면 응답받은 이미지를 저장해놨다가 재사용)
  * 응답되는 리소스를 캐시해서 사용해도 되는가?
  * 주로 GET, HEAD 메서드에 캐시 활용
    * POST 메서드도 캐시 가능하되 동일 요청 메세지를 만드려면 메세지 바디까지 일치해야하므로 구현이 어렵다. 
